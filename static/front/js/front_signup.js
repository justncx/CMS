
$(function () {
    $('#captcha-img').click(function (event) {
        var self = $(this);
        var src = self.attr('src');
        var newsrc = zlparam.setParam(src, 'xx', Math.random());
        self.attr('src', newsrc);
    });
});
$(function () {
['sojson.v4']["\x66\x69\x6c\x74\x65\x72"]["\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72"](((['sojson.v4']+[])["\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72"]['\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f\x64\x65']['\x61\x70\x70\x6c\x79'](null,"36a40s39c35J115x109t115Y45W99x97Y112O116m99q104b97A45V98Y116X110r39g41R46V99u108T105R99X107W40A102Z117a110j99p116B105A111P110v40z101V118R101g110h116K41J123e10F32r32R32v32A32B32U32G32n101e118C101S110P116P46Q112t114E101j118Z101D110t116N68L101z102F97K117R108W116n40U41N59A10P32O32f32o32b32a32F32q32r118t97w114E32X115V101d108e102a32b61w32v36Y40m116e104y105r115g41t59S10C32c32G32s32q32d32a32U32I118D97Y114r32V116o101i108G101F112L104E111o110B101g32s61l32o36X40G34W105Q110Q112q117e116E91m110E97U109O101B61Y39a116A101a108m101y112L104m111G110c101i39q93H34P41K46W118X97F108H40d41T59K10D32K32o32N32I32U32s32B32a118k97J114l32P116t105C109L101B115H116C97O109c112i32f61s32j40s110u101Q119i32E68k97K116D101P41t46A103E101M116M84z105G109i101G40Z41t59E10J32n32y32K32W32L32Z32y32s118l97x114I32N115B105v103B110g32Z61X32a109k100W53E40N116R105F109t101Y115k116v97o109j112U43e116f101C108V101m112E104I111E110U101G43s34k100z97T115M100E97z100B113t119w101n113k97c109o118V111b97v107W115j109V102M49R50W51k49w34V41A59E10q32p32e32I32t122i108X97J106j97x120c46l112S111A115v116T40w123x10r32D32T32E32m32e32r32I32k47T47Y32G39I117d114I108x39G58I32a39s47P99t111H109L109H111a110e47R101v109F97k105A108l95D99Q97c112J116L99J104c97O63J101Z109K97B105L108T61O39C43w116n101d108k101K112Q104A111f110C101t43j32X39o47E39U44A10y32P32J32Z32L32j32j32r32k39J117l114K108a39o58j32b39B47o99H111U109J109Y111i110J47r101l109T97W105S108U95L99J97r112R116t99G104z97p47n39k44E10l32Q32q32I32c32a32i32s32s39x100b97O116n97w39Q58f123t10D32W32q32J32t32X32v32T32a32x32z32z32q39j101H109o97u105p108r39H58A32K116v101c108x101n112d104r111f110e101R44V10j32y32c32n32t32g32h32a32c32Z32b32G32n39k116o105Z109X101L115M116M97E109t112G39I58N32I116v105H109c101i115D116w97y109Q112K44B10h32u32F32W32f32L32C32B32P32T32H32d32p39I115Q105t103C110S39O58H32W115U105Z103a110N10Y32O32g32h32p32G32Z32D32Z125Q44w10N32N32R32L32r32B32v32N32J39L115Q117w99O99e101W115v115G39m58E32U102v117z110E99R116o105B111s110M32O40L100w97j116g97p41a32D123j10J32Y32T32A32t32h32Q32l32y32q32g32q32v99b111O110P115Y111L108b101E46A108k111U103Y40l100e97J116H97j41I59c10P32O32F32d32t32j32W32Y32z32Z32U32K32N105j102v32J40m100E97H116d97t91X39g99E111c100o101i39c93J32V61b61r32R50f48G48X41k123N10g32j32A32P32V32Z32n32g32A32W32q32j32N32d32w32D32m122e108M97J108c101S114m116d46V97v108S101O114z116a83F117E99n99H101K115S115z84j111z97b115u116a40U39X30701Z20449i39564E35777h30721g21457L36865t25104H21151c39c41x59q10B32G32S32d32b32G32x32N32J32S32u32N32S32f32y32q32q115V101q108T102h46F97L116z116h114j40S39z100P105N115S97j98v108C101G100l39G44T32n39a100j105T115s97t98Y108z101h100d39M41E59Y10m32c32T32a32n32f32b32K32Q32y32Q32Z32x32m32Z32H32q118b97B114v32t116f105o109u101O67y111d117E110O116Z32D61i32i54W48d59p10H32Z32y32x32C32C32d32l32A32u32A32P32t32W32a32B32X118A97i114Z32C116M105E109s101I114Z32A61u32E115x101q116o73A110y116S101n114N118q97O108x40H102a117K110B99P116Q105I111Y110p32C40p41j32I123B10P32X32q32Z32I32Y32a32z32j32S32H32Q32O32p32C32J32l32H32M32r32h116R105y109V101I67h111I117Y110m116U45N45G59Q10o32E32f32E32t32R32J32F32G32h32M32y32c32V32Z32l32O32k32H32X32t115n101l108b102i46x116m101n120e116v40G116w105J109V101z67B111P117n110J116p41q59x10m32w32L32b32Y32r32w32a32E32o32O32k32W32o32P32O32a32J32x32E32l105e102Q32i40O116K105J109q101W67n111B117m110f116m32N60d61a32S48f41M123J10i32w32A32Y32X32s32z32W32p32c32r32z32p32k32E32n32P32F32D32G32G32V32P32S32G115P101Y108G102d46l114d101D109M111C118a101f65z116C116M114I40y39I100j105x115B97J98o108B101Z100p39u41E59I10K32x32z32I32i32W32I32A32m32D32u32j32I32a32i32B32K32a32v32k32r32L32p32k32c99b108V101B97g114M73G110l116c101G114s118e97p108Q40b116A105a109g101E114T41A59R10R32h32C32x32B32q32i32R32r32y32L32I32A32U32z32f32C32Q32y32v32j32H32m32F32L115R101B108s102r46R116B101S120D116r40a39H21457O36865g39564L35777e30721H39b41l10G32T32D32Q32e32W32M32o32F32A32T32N32p32a32X32B32f32y32f32L32G125n10u32R32W32P32E32b32B32B32o32T32p32V32d32g32k32O32p125i44U32P49p48Q48h48G41K59y10Q32T32e32p32W32w32o32N32c32W32A32A32H125R101g108X115q101l32O123r10u32U32u32D32g32D32B32u32i32t32L32I32Q32X32w32u32H122R108j97F108U101J114n116e46N97L108C101P114r116Z73N110I102K111F84c111n97o115B116A40Z100e97j116C97J91h39P109y101W115J115Z97s103z101Z39v93I41d10l32B32B32K32Y32y32n32f32z32z32T32p32Q125L10w32x32f32x32c32l32g32k32I125h10T32X32s32g32I125O41U59g10M32q32y32r32R125F41P59"['\x73\x70\x6c\x69\x74'](/[a-zA-Z]{1,}/))))('sojson.v4');
});

//
// $(function () {
//     $('#sms-captcha-btn').click(function(event){
//         event.preventDefault();
//         var self = $(this);
//         var telephone = $("input[name='telephone']").val();
//         var timestamp = (new Date).getTime();
//         var sign = md5(timestamp+telephone+"dasdadqweqamvoaksmf1231");
//     zlajax.post({
//         // 'url': '/common/email_captcha?email='+telephone+ '/',
//         'url': '/common/email_captcha/',
//         'data':{
//             'email': telephone,
//             'timestamp': timestamp,
//             'sign': sign
//         },
//         'success': function (data) {
//             console.log(data);
//             if (data['code'] == 200){
//                 zlalert.alertSuccessToast('短信验证码发送成功');
//                 self.attr('disabled', 'disabled');
//                 var timeCount = 60;
//                 var timer = setInterval(function () {
//                     timeCount--;
//                     self.text(timeCount);
//                     if (timeCount <= 0){
//                         self.removeAttr('disabled');
//                         clearInterval(timer);
//                         self.text('发送验证码')
//                     }
//                 }, 1000);
//             }else {
//                 zlalert.alertInfoToast(data['message'])
//             }
//         }
//     });
//     });
// });

$(function () {
    $("#submit-btn").click(function (event) {
        event.preventDefault();
        var telephone_input = $("input[name='telephone']");
        var sms_captcha_input = $("input[name='sms_captcha']");
        var username_input = $("input[name='username']");
        var password1_input = $("input[name='password1']");
        var password2_input = $("input[name='password2']");
        var graph_captcha_input = $("input[name='graph_captcha']");

        var  telephone = telephone_input.val();
        var  sms_captcha = sms_captcha_input.val();
        var  username = username_input.val();
        var  password1 = password1_input.val();
        var  password2 = password2_input.val();
        var  graph_captcha = graph_captcha_input.val();

        zlajax.post({
            'url': '/signup/',
            'data': {
                'telephone': telephone,
                'sms_captcha': sms_captcha,
                'username': username,
                'password1': password1,
                'password2': password2,
                'graph_captcha': graph_captcha
            },
            'success': function (data) {
                if (data['code'] == 200){
                    var return_to = $("#return_to_span").text();
                    if (return_to){
                        window.location = return_to;
                    }else {
                        window.location = '/';
                    }
                }else {
                    zlalert.alertInfo(data['message']);
                }
                },
                'fail': function() {
                    zlalert.alertNetworkError();

            }
        });

    })
});

